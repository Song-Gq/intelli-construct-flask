webpackJsonp([1],{"/NSH":function(t,e){},"/bWE":function(t,e){},"6oa8":function(t,e){},D4kW:function(t,e){},Dbc7:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("7+uW"),i={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticStyle:{margin:"0 auto"},attrs:{id:"app"}},[o("el-container",[o("el-header",{staticStyle:{padding:"0"}},[o("el-menu",{staticClass:"el-menu-demo",staticStyle:{height:"100%"},attrs:{"default-active":t.activeIndex,mode:"horizontal",router:!0,"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"},on:{select:t.handleSelect}},[o("el-menu-item",{staticStyle:{"font-size":"18px"},attrs:{index:"index"}},[t._v("基于人工智能的建造安全管理创新示范")]),t._v(" "),o("el-menu-item",{staticStyle:{"font-size":"18px"},attrs:{index:"equip"}},[t._v("人员识别")]),t._v(" "),o("el-menu-item",{staticStyle:{"font-size":"18px"},attrs:{index:"driverFace"}},[t._v("驾驶室动作")]),t._v(" "),o("el-menu-item",{staticStyle:{"font-size":"18px"},attrs:{index:"excavatorState"}},[t._v("大型设备")]),t._v(" "),o("el-menu-item",{staticStyle:{"font-size":"18px"},attrs:{index:"driverAction"}},[t._v("设备操作")]),t._v(" "),o("el-menu-item",{staticStyle:{"font-size":"18px"},attrs:{index:"waveRecognition"}},[t._v("声纹识别")]),t._v(" "),o("div",[o("el-image",{staticStyle:{height:"80%",margin:"5px auto auto auto",position:"absolute",right:"5%"},attrs:{src:a("lUYF"),fit:"scale-down"}}),t._v(" "),o("el-image",{staticStyle:{height:"80%",margin:"5px auto auto auto",position:"absolute",right:"1%"},attrs:{src:a("zfvm"),fit:"scale-down"}})],1)],1)],1),t._v(" "),o("el-main",[o("router-view")],1),t._v(" "),o("el-footer",{staticStyle:{"font-size":"12px",color:"grey",height:"60px"}},[o("div",{staticStyle:{"margin-top":"5px",color:"royalblue"}},[t._v("\n          Source Code Repository on\n          "),o("el-link",{staticStyle:{"font-size":"12px",color:"royalblue"},attrs:{href:"https://github.com/Song-Gq/intelli-construct-vue"}},[t._v("\n            https://github.com/Song-Gq/intelli-construct-vue\n          ")])],1),t._v(" "),o("div",{staticStyle:{"margin-top":"5px"}},[t._v("\n          Copyright © 2023 Trusted AI Lab, Shanghai. All Rights Reserved\n        ")])])],1)],1)},staticRenderFns:[]};var r=a("VU/8")({name:"App",data:function(){return{activeIndex:"index",sumPicNum:0}},methods:{handleSelect:function(t,e){},getActiveMenu:function(){this.activeIndex=this.$router.currentRoute.path.substring(1)}},created:function(){this.getActiveMenu()},mounted:function(){}},i,!1,function(t){a("iXrt")},null,null).exports,n=a("/ocq"),s=a("mtWM"),l=a.n(s),c={name:"Uploader",data:function(){return{fileList:[],prog:0,in_prog:!1,prog_stat:null,prog_text:"正在上传文件，速度取决于网络状况，请耐心等待...",tableData:[],misData:[],timer:null,f_exist:!1,server_available:!1,recog_started:!1}},computed:{chosenfilenum:function(){return this.fileList.length},resultfilenum:function(){return this.tableData.length}},methods:{rowStatus:function(t){t.row,t.rowIndex;return{"background-color":"oldlace"}},handleChange:function(t,e){var a=t.name.lastIndexOf("."),o=t.name.substring(a,t.name.length),i=".jpeg"===o||".jpg"===o||".png"===o,r=t.size/1024/1024<1;i||(this.$message.error("上传图片只能是 JPG/PNG 格式!"),e.pop()),r||(this.$message.error("上传文件大小不能超过 1MB!"),e.pop()),e.length>200&&(this.$message.error("单次识别数量不能超过 200!"),e.pop()),this.fileList=e},submitUpload:function(){var t=this;this.getToken().then(function(e){window.sessionStorage.setItem("token",e.data),t.server_available=!0,t.in_prog=!0,t.getProgress();var a=new FormData,o=1;t.fileList.forEach(function(t){a.append("id="+o.toString()+"="+t.name,t.raw),o+=1}),t.uploadFile(a).then(function(e){console.log(e),console.log(e.status),t.prog=100,t.prog_stat="success",t.prog_text="识别成功，刷新页面可重新上传",t.clearTimer();var a=e.data,o=a.res;for(var i in o)t.tableData.push({date:o[i][2],name:o[i][1],type:o[i][0],result:o[i][3]});var r=a.mis;if(null!==r)for(var n in r)t.misData.push({date:r[n][2],name:r[n][1],type:r[n][0],result:r[n][3]})}).catch(function(e){console.log(e),t.$message.error("上传识别失败！若文件总大小超过20MB，请尝试分批上传"),t.prog_stat="exception",t.prog_text="请刷新页面重试",t.clearTimer()})}).catch(function(e){console.log(e),t.server_available=!1,t.$message.error("服务当前同时使用人数过多！请稍后重试...")})},uploadFile:function(t){return this.$axios.post(this.$targetDomain+"/api/recognition",t,{headers:{"Content-Type":"multipart/form-data",token:window.sessionStorage.getItem("token")}})},getProgress:function(){var t=this;this.timer=setInterval(function(){t.getStatus().then(function(e){-2===e.data?t.recog_started||(t.prog_text="正在上传文件，速度取决于网络状况，请耐心等待...",t.prog=0):-1===e.data?(t.$message.warning("进度获取出现问题...暂不显示实时进度"),t.clearTimer(),t.prog_text="仍正在识别，请耐心等待数分钟...如仍无结果请刷新页面重试"):(t.recog_started=!0,t.prog_text="已上传完成，正在识别，请耐心等待...",t.prog=Math.round(100*e.data),100===t.prog&&t.clearTimer())}).catch(function(e){t.$message.warning("进度获取出现问题...暂不显示实时进度"),t.clearTimer()})},2e3)},getStatus:function(){return this.$axios.get(this.$targetDomain+"/api/getprog",{params:{token:window.sessionStorage.getItem("token"),timeout:2e3}})},clearTimer:function(){clearInterval(this.timer),this.timer=null},export2excel:function(){this.getExcel().then(function(t){var e=new Blob([t.data],{type:"application/vnd.ms-excel"}),a=document.createElement("a"),o=new Date;a.download="核酸检测报告-"+o.getFullYear()+"-"+o.getMonth()+"-"+o.getDate()+"-"+o.getHours()+"-"+o.getMinutes()+"-"+o.getSeconds()+".xls",a.style.display="none",a.href=URL.createObjectURL(e),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)})},getExcel:function(){return this.$axios.get(this.$targetDomain+"/api/getexcel",{params:{token:window.sessionStorage.getItem("token")},responseType:"arraybuffer"})},getToken:function(){return this.$axios.get(this.$targetDomain+"/api/gettoken",{params:{}})},destroyToken:function(){var t=window.sessionStorage.getItem("token");if(null!=t)return this.$axios.delete(this.$targetDomain+"/api/destroytoken",{params:{token:t}})}},mode:"history",beforeDestroy:function(){clearInterval(this.timer),this.timer=null},beforeMount:function(){window.sessionStorage.removeItem("token"),this.server_available=!1},mounted:function(){window.addEventListener("beforeunload",function(t){})},created:function(){var t=this;this.$nextTick(function(){t.$refs.upload.$children[0].$refs.input.webkitdirectory=!0})}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"margin-top":"30px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.in_prog,expression:"in_prog"}]},[t._v("\n    "+t._s(t.prog_text)+"\n    "),a("el-progress",{staticStyle:{margin:"5px auto 50px auto",width:"80%"},attrs:{percentage:t.prog,"text-inside":!0,"stroke-width":26,status:t.prog_stat}})],1),t._v(" "),a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:2}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{float:"left","margin-left":"150%"},attrs:{action:"#",multiple:!0,"auto-upload":!1,"on-change":t.handleChange,"file-list":t.fileList,disabled:t.in_prog,"show-file-list":!1}},[a("el-button",{staticStyle:{"font-size":"14px"},attrs:{slot:"trigger",size:"small",type:"primary",disabled:t.in_prog},slot:"trigger"},[t._v("\n            选取文件")])],1)],1),t._v(" "),a("el-col",{staticStyle:{"pointer-events":"none"},attrs:{span:8}},[a("el-upload",{ref:"upload",staticClass:"upload",attrs:{action:"#",multiple:!0,"auto-upload":!1,"on-change":t.handleChange,"file-list":t.fileList,disabled:t.in_prog}},[a("el-button",{staticStyle:{"pointer-events":"auto","font-size":"14px"},attrs:{slot:"trigger",size:"small",type:"primary",disabled:t.in_prog},slot:"trigger"},[t._v("选取文件夹")]),t._v(" "),a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"5px","font-size":"14px"},attrs:{slot:"tip"},slot:"tip"},[t._v("\n            文件总大小不能超过20MB")]),t._v(" "),a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"5px","font-size":"14px"},attrs:{slot:"tip"},slot:"tip"},[t._v("\n            选取文件数："+t._s(t.chosenfilenum))])],1)],1),t._v(" "),a("el-col",{attrs:{span:2}},[0===t.fileList.length?a("el-button",{staticStyle:{float:"right","margin-right":"150%","font-size":"14px"},attrs:{size:"small",type:"success",disabled:!0}},[t._v("开始识别")]):t._e(),t._v(" "),0!==t.fileList.length?a("el-button",{staticStyle:{float:"right","margin-right":"150%","font-size":"14px"},attrs:{size:"small",type:"success",disabled:t.in_prog},on:{click:t.submitUpload}},[t._v("开始识别")]):t._e()],1),t._v(" "),a("el-col",{attrs:{span:12}},[[0!==t.misData.length?a("el-result",{staticStyle:{"padding-top":"20px"},attrs:{icon:"warning",title:"提请注意",subTitle:"以下结果请人工复核"}}):t._e(),t._v(" "),0!==t.misData.length?a("el-table",{staticStyle:{width:"100%","margin-bottom":"50px"},attrs:{data:t.misData,"row-style":t.rowStatus}},[a("el-table-column",{attrs:{prop:"date",label:"日期"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"type",label:"类型"}}),t._v(" "),a("el-table-column",{attrs:{prop:"result",label:"结果"}})],1):t._e(),t._v(" "),a("div",{staticStyle:{"font-size":"14px"}},[t._v("\n            识别文件数："+t._s(t.resultfilenum)+"\n          ")]),t._v(" "),0!==t.tableData.length?a("el-button",{staticStyle:{margin:"20px auto 20px auto"},attrs:{size:"small",type:"success"},on:{click:t.export2excel}},[t._v("导出至Excel")]):t._e(),t._v(" "),a("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.tableData,stripe:!0,"max-height":800,size:"small"}},[a("el-table-column",{attrs:{prop:"date",label:"日期"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"type",label:"类型"}}),t._v(" "),a("el-table-column",{attrs:{prop:"result",label:"结果"}})],1)]],2)],1),t._v(" "),a("iframe",{staticStyle:{"margin-top":"40px"},attrs:{width:"1120",height:"630",src:"//player.bilibili.com/player.html?aid=764029001&bvid=BV1Ur4y1C73M&cid=438374904&page=1",scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true"}})],1)},staticRenderFns:[]};a("VU/8")(c,p,!1,function(t){a("sDrd")},"data-v-f408862a",null).exports;var g={name:"Navi",data:function(){return{fileList:[],prog:0,in_prog:!1,prog_stat:null,prog_text:"正在上传文件，速度取决于网络状况，请耐心等待...",tableData:[],misData:[],timer:null,f_exist:!1,server_available:!1,recog_started:!1}},computed:{chosenfilenum:function(){return this.fileList.length},resultfilenum:function(){return this.tableData.length}},methods:{rowStatus:function(t){t.row,t.rowIndex;return{"background-color":"oldlace"}},handleChange:function(t,e){var a=t.name.lastIndexOf("."),o=".json"===t.name.substring(a,t.name.length),i=t.size/1024/1024<10;o||(this.$message.error("上传文件只能是 JSON 格式!"),e.pop()),i||(this.$message.error("上传文件大小不能超过 10MB!"),e.pop()),e.length>200&&(this.$message.error("单次识别数量不能超过 200!"),e.pop()),this.fileList=e},submitUpload:function(){var t=this;this.getToken().then(function(e){window.sessionStorage.setItem("token",e.data),t.server_available=!0,t.in_prog=!0;for(var a=function(e){var a=new FormData;a.append("id="+e.toString()+"="+file.name,file.raw),t.uploadFile(a).then(function(a){console.log(a),console.log(a.status),t.prog=e/t.fileList.length;a.data.res}).catch(function(e){console.log(e),t.$message.error("上传识别失败！"),t.prog_stat="exception",t.prog_text="请刷新页面重试",t.clearTimer()})},o=0;o<t.fileList.length;o++)a(o)}).catch(function(e){console.log(e),t.server_available=!1,t.$message.error("服务当前同时使用人数过多！请稍后重试...")})},uploadFile:function(t){return this.$axios.post(this.$targetDomain+"/api/driverAction",t,{headers:{"Content-Type":"multipart/form-data",token:window.sessionStorage.getItem("token")}})},getProgress:function(){var t=this;this.timer=setInterval(function(){t.getStatus().then(function(e){-2===e.data?t.recog_started||(t.prog_text="正在上传文件，速度取决于网络状况，请耐心等待...",t.prog=0):-1===e.data?(t.$message.warning("进度获取出现问题...暂不显示实时进度"),t.clearTimer(),t.prog_text="仍正在识别，请耐心等待数分钟...如仍无结果请刷新页面重试"):(t.recog_started=!0,t.prog_text="已上传完成，正在识别，请耐心等待...",t.prog=Math.round(100*e.data),100===t.prog&&t.clearTimer())}).catch(function(e){t.$message.warning("进度获取出现问题...暂不显示实时进度"),t.clearTimer()})},2e3)},getStatus:function(){return this.$axios.get(this.$targetDomain+"/api/getprog",{params:{token:window.sessionStorage.getItem("token"),timeout:2e3}})},clearTimer:function(){clearInterval(this.timer),this.timer=null},export2excel:function(){this.getExcel().then(function(t){var e=new Blob([t.data],{type:"application/vnd.ms-excel"}),a=document.createElement("a"),o=new Date;a.download="核酸检测报告-"+o.getFullYear()+"-"+o.getMonth()+"-"+o.getDate()+"-"+o.getHours()+"-"+o.getMinutes()+"-"+o.getSeconds()+".xls",a.style.display="none",a.href=URL.createObjectURL(e),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)})},getExcel:function(){return this.$axios.get(this.$targetDomain+"/api/getexcel",{params:{token:window.sessionStorage.getItem("token")},responseType:"arraybuffer"})},getToken:function(){return this.$axios.get(this.$targetDomain+"/api/gettoken",{params:{}})},destroyToken:function(){var t=window.sessionStorage.getItem("token");if(null!=t)return this.$axios.delete(this.$targetDomain+"/api/destroytoken",{params:{token:t}})}},mode:"history",beforeDestroy:function(){clearInterval(this.timer),this.timer=null},beforeMount:function(){window.sessionStorage.removeItem("token"),this.server_available=!1},mounted:function(){window.addEventListener("beforeunload",function(t){})},created:function(){var t=this;this.$nextTick(function(){t.$refs.upload.$children[0].$refs.input.webkitdirectory=!0})}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"margin-top":"30px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.in_prog,expression:"in_prog"}]},[t._v("\n    "+t._s(t.prog_text)+"\n    "),a("el-progress",{staticStyle:{margin:"5px auto 50px auto",width:"80%"},attrs:{percentage:t.prog,"text-inside":!0,"stroke-width":26,status:t.prog_stat}})],1),t._v(" "),a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:1}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{float:"left","margin-left":"150%"},attrs:{action:"#",multiple:!0,"auto-upload":!1,"on-change":t.handleChange,"file-list":t.fileList,disabled:t.in_prog,"show-file-list":!1}},[a("el-button",{staticStyle:{"font-size":"14px"},attrs:{slot:"trigger",size:"small",type:"primary",disabled:t.in_prog},slot:"trigger"},[t._v("\n          批量选取JSON")])],1)],1),t._v(" "),a("el-col",{staticStyle:{"pointer-events":"none"},attrs:{span:3}},[a("el-upload",{ref:"upload",staticClass:"upload",attrs:{action:"#",multiple:!0,"auto-upload":!1,"on-change":t.handleChange,"file-list":t.fileList,disabled:t.in_prog}},[a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"30px","font-size":"14px"},attrs:{slot:"tip"},slot:"tip"},[t._v("\n          文件大小不能超过10MB")]),t._v(" "),a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"5px","font-size":"14px"},attrs:{slot:"tip"},slot:"tip"},[t._v("\n          选取文件数："+t._s(t.chosenfilenum))])])],1),t._v(" "),a("el-col",{attrs:{span:1}},[0===t.fileList.length?a("el-button",{staticStyle:{float:"right","margin-right":"150%","font-size":"14px"},attrs:{size:"small",type:"success",disabled:!0}},[t._v("开始识别")]):t._e(),t._v(" "),0!==t.fileList.length?a("el-button",{staticStyle:{float:"right","margin-right":"150%","font-size":"14px"},attrs:{size:"small",type:"success",disabled:t.in_prog},on:{click:t.submitUpload}},[t._v("开始识别")]):t._e()],1),t._v(" "),a("el-col",{attrs:{span:19}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.in_prog,expression:"in_prog"}]},[t._v("\n        "+t._s(t.prog_text)+"\n        "),a("el-progress",{staticStyle:{margin:"5px auto 50px auto",width:"80%"},attrs:{percentage:t.prog,"text-inside":!0,"stroke-width":26,status:t.prog_stat}})],1)])],1)],1)},staticRenderFns:[]};var d=a("VU/8")(g,u,!1,function(t){a("/bWE")},"data-v-6e37b15e",null).exports,m=a("KkKn"),h={props:["figData","figLayout"],components:{Plotly:m.Plotly},name:"Loc2d",data:function(){return{}}},f={render:function(){var t=this.$createElement;return(this._self._c||t)("Plotly",{attrs:{data:this.figData,layout:this.figLayout,"display-mode-bar":!1}},[this._v("}")])},staticRenderFns:[]};var _=a("VU/8")(h,f,!1,function(t){a("R/11")},"data-v-15d79a79",null).exports,v={name:"Navi",components:{DriverActionBatch:d},data:function(){return{fileList:[],prog:0,in_prog:!1,prog_stat:null,prog_text:"正在上传文件，速度取决于网络状况，请耐心等待...",tableData:[],misData:[],timer:null,f_exist:!1,server_available:!1,recog_started:!1}},computed:{chosenfilenum:function(){return this.fileList.length},resultfilenum:function(){return this.tableData.length}},methods:{rowStatus:function(t){t.row,t.rowIndex;return{"background-color":"oldlace"}},handleChange:function(t,e){var a=t.name.lastIndexOf("."),o=".json"===t.name.substring(a,t.name.length),i=t.size/1024/1024<10;o||(this.$message.error("上传文件只能是 JSON 格式!"),e.pop()),i||(this.$message.error("上传文件大小不能超过 10MB!"),e.pop()),e.length>200&&(this.$message.error("单次识别数量不能超过 200!"),e.pop()),this.fileList=e},submitUpload:function(){var t=this;this.getToken().then(function(e){window.sessionStorage.setItem("token",e.data),t.server_available=!0,t.in_prog=!0,t.getProgress();var a=new FormData,o=1;t.fileList.forEach(function(t){a.append("id="+o.toString()+"="+t.name,t.raw),o+=1}),t.uploadFile(a).then(function(e){console.log(e),console.log(e.status),t.prog=100,t.prog_stat="success",t.prog_text="识别成功，刷新页面可重新上传",t.clearTimer();var a=e.data,o=a.res;for(var i in o)t.tableData.push({date:o[i][2],name:o[i][1],type:o[i][0],result:o[i][3]});var r=a.mis;if(null!==r)for(var n in r)t.misData.push({date:r[n][2],name:r[n][1],type:r[n][0],result:r[n][3]})}).catch(function(e){console.log(e),t.$message.error("上传识别失败！若文件总大小超过20MB，请尝试分批上传"),t.prog_stat="exception",t.prog_text="请刷新页面重试",t.clearTimer()})}).catch(function(e){console.log(e),t.server_available=!1,t.$message.error("服务当前同时使用人数过多！请稍后重试...")})},uploadFile:function(t){return this.$axios.post(this.$targetDomain+"/api/recognition",t,{headers:{"Content-Type":"multipart/form-data",token:window.sessionStorage.getItem("token")}})},getProgress:function(){var t=this;this.timer=setInterval(function(){t.getStatus().then(function(e){-2===e.data?t.recog_started||(t.prog_text="正在上传文件，速度取决于网络状况，请耐心等待...",t.prog=0):-1===e.data?(t.$message.warning("进度获取出现问题...暂不显示实时进度"),t.clearTimer(),t.prog_text="仍正在识别，请耐心等待数分钟...如仍无结果请刷新页面重试"):(t.recog_started=!0,t.prog_text="已上传完成，正在识别，请耐心等待...",t.prog=Math.round(100*e.data),100===t.prog&&t.clearTimer())}).catch(function(e){t.$message.warning("进度获取出现问题...暂不显示实时进度"),t.clearTimer()})},2e3)},getStatus:function(){return this.$axios.get(this.$targetDomain+"/api/getprog",{params:{token:window.sessionStorage.getItem("token"),timeout:2e3}})},clearTimer:function(){clearInterval(this.timer),this.timer=null},export2excel:function(){this.getExcel().then(function(t){var e=new Blob([t.data],{type:"application/vnd.ms-excel"}),a=document.createElement("a"),o=new Date;a.download="核酸检测报告-"+o.getFullYear()+"-"+o.getMonth()+"-"+o.getDate()+"-"+o.getHours()+"-"+o.getMinutes()+"-"+o.getSeconds()+".xls",a.style.display="none",a.href=URL.createObjectURL(e),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)})},getExcel:function(){return this.$axios.get(this.$targetDomain+"/api/getexcel",{params:{token:window.sessionStorage.getItem("token")},responseType:"arraybuffer"})},getToken:function(){return this.$axios.get(this.$targetDomain+"/api/gettoken",{params:{}})},destroyToken:function(){var t=window.sessionStorage.getItem("token");if(null!=t)return this.$axios.delete(this.$targetDomain+"/api/destroytoken",{params:{token:t}})}},mode:"history",beforeDestroy:function(){clearInterval(this.timer),this.timer=null},beforeMount:function(){window.sessionStorage.removeItem("token"),this.server_available=!1},mounted:function(){window.addEventListener("beforeunload",function(t){})},created:function(){var t=this;this.$nextTick(function(){t.$refs.upload.$children[0].$refs.input.webkitdirectory=!0})}},x={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"margin-top":"30px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.in_prog,expression:"in_prog"}]},[t._v("\n      "+t._s(t.prog_text)+"\n      "),a("el-progress",{staticStyle:{margin:"5px auto 50px auto",width:"80%"},attrs:{percentage:t.prog,"text-inside":!0,"stroke-width":26,status:t.prog_stat}})],1),t._v(" "),a("el-row",{attrs:{gutter:40}}),t._v(" "),a("iframe",{staticStyle:{"margin-top":"40px"},attrs:{width:"1120",height:"630",src:"//player.bilibili.com/player.html?aid=764029001&bvid=BV1Ur4y1C73M&cid=438374904&page=1",scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true"}})],1)},staticRenderFns:[]};var b=a("VU/8")(v,x,!1,function(t){a("XR2M")},"data-v-4262d906",null).exports,y={components:{Loc2d:_},name:"ExcavatorState",data:function(){return{fileList:[],prog:0,in_prog:!1,prog_stat:null,prog_text:"正在上传文件，速度取决于网络状况，请耐心等待...",tableData:[],misData:[],timer:null,f_exist:!1,server_available:!1,recog_started:!1,areaFig:[{x:[],y:[],type:"scatter"}],posFig:[{x:[],y:[],type:"scatter"},{x:[],y:[],type:"scatter"}],recog_res_icon:"error",recog_res_text:"Unknown",recog_res_sub_text:"Recognition Error"}},computed:{chosenfilenum:function(){return this.fileList.length},resultfilenum:function(){return this.tableData.length}},methods:{rowStatus:function(t){t.row,t.rowIndex;return{"background-color":"oldlace"}},handleChange:function(t,e){var a=t.name.lastIndexOf("."),o=".mp4"===t.name.substring(a,t.name.length).toLowerCase(),i=t.size/1024/1024<10;o||(this.$message.error("上传视频只能是 MP4 格式!"),e.pop()),i||(this.$message.error("上传文件大小不能超过 10MB!"),e.pop()),e.length>1&&(this.$message.error("单次识别数量不能超过 1!"),e.pop()),this.fileList=e},submitUpload:function(){var t=this;this.getToken().then(function(e){window.sessionStorage.setItem("token",e.data),t.server_available=!0,t.in_prog=!0,t.getProgress();var a=new FormData,o=1;t.fileList.forEach(function(t){a.append("id="+o.toString()+"="+t.name,t.raw),o+=1}),t.uploadFile(a).then(function(e){console.log(e),console.log(e.status),t.prog=100,t.prog_stat="success",t.prog_text="识别成功，刷新页面可重新上传",t.clearTimer();var a=e.data,o=a.state;t.recog_res_icon="info",t.recog_res_sub_text="Recognition Done",t.recog_res_text=1===o?"设备正在工作":"设备未在工作";var i=a.res;for(var r in i){t.tableData.push({frame:i[r][0],excav:i[r][1],top:i[r][2],left:i[r][3],width:i[r][4],height:i[r][5],area:i[r][6]});var n=i[r][3]+i[r][4]/2,s=i[r][2]+i[r][5]/2;t.areaFig[0].x.push(i[r][0]),t.areaFig[0].y.push(i[r][6]),t.posFig[0].x.push(i[r][0]),t.posFig[0].y.push(n),t.posFig[1].x.push(i[r][0]),t.posFig[1].y.push(s)}console.log(t.posFig);var l=a.mis;if(null!==l)for(var c in l)t.misData.push({date:l[c][2],name:l[c][1],type:l[c][0],result:l[c][3]})}).catch(function(e){console.log(e),t.$message.error("上传识别失败！"),t.prog_stat="exception",t.prog_text="请刷新页面重试",t.clearTimer()})}).catch(function(e){console.log(e),t.server_available=!1,t.$message.error("服务当前同时使用人数过多！请稍后重试...")})},uploadFile:function(t){return this.$axios.post(this.$targetDomain+"/api/excavator",t,{headers:{"Content-Type":"multipart/form-data",token:window.sessionStorage.getItem("token")}})},getProgress:function(){var t=this;this.timer=setInterval(function(){t.getStatus().then(function(e){-2===e.data?t.recog_started||(t.prog_text="正在上传文件，速度取决于网络状况，请耐心等待...",t.prog=0):-1===e.data?(t.clearTimer(),t.prog_text="仍正在识别，请耐心等待数分钟...如仍无结果请刷新页面重试"):(t.recog_started=!0,t.prog_text="已上传完成，正在识别，请耐心等待...",t.prog=Math.round(100*e.data),100===t.prog&&t.clearTimer())}).catch(function(e){t.clearTimer()})},2e3)},getStatus:function(){return this.$axios.get(this.$targetDomain+"/api/getprog",{params:{token:window.sessionStorage.getItem("token"),timeout:2e3}})},clearTimer:function(){clearInterval(this.timer),this.timer=null},export2excel:function(){this.getExcel().then(function(t){var e=new Blob([t.data],{type:"application/vnd.ms-excel"}),a=document.createElement("a"),o=new Date;a.download="核酸检测报告-"+o.getFullYear()+"-"+o.getMonth()+"-"+o.getDate()+"-"+o.getHours()+"-"+o.getMinutes()+"-"+o.getSeconds()+".xls",a.style.display="none",a.href=URL.createObjectURL(e),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)})},getExcel:function(){return this.$axios.get(this.$targetDomain+"/api/getexcel",{params:{token:window.sessionStorage.getItem("token")},responseType:"arraybuffer"})},getToken:function(){return this.$axios.get(this.$targetDomain+"/api/gettoken",{params:{}})},destroyToken:function(){var t=window.sessionStorage.getItem("token");if(null!=t)return this.$axios.delete(this.$targetDomain+"/api/destroytoken",{params:{token:t}})}},mode:"history",beforeDestroy:function(){clearInterval(this.timer),this.timer=null},beforeMount:function(){window.sessionStorage.removeItem("token"),this.server_available=!1},mounted:function(){window.addEventListener("beforeunload",function(t){})},created:function(){var t=this;this.$nextTick(function(){t.$refs.upload.$children[0].$refs.input.webkitdirectory=!0})}},w={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"margin-top":"30px"}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:1}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{float:"left","margin-left":"150%"},attrs:{action:"#",multiple:!0,"auto-upload":!1,"on-change":t.handleChange,"file-list":t.fileList,disabled:t.in_prog,"show-file-list":!1}},[a("el-button",{staticStyle:{"font-size":"14px"},attrs:{slot:"trigger",size:"small",type:"primary",disabled:t.in_prog},slot:"trigger"},[t._v("\n            选取视频文件")])],1)],1),t._v(" "),a("el-col",{staticStyle:{"pointer-events":"none"},attrs:{span:3}},[a("el-upload",{ref:"upload",staticClass:"upload",attrs:{action:"#",multiple:!0,"auto-upload":!1,"on-change":t.handleChange,"file-list":t.fileList,disabled:t.in_prog}},[a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"30px","font-size":"14px"},attrs:{slot:"tip"},slot:"tip"},[t._v("\n            文件大小不能超过10MB")]),t._v(" "),a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"5px","font-size":"14px"},attrs:{slot:"tip"},slot:"tip"},[t._v("\n            选取文件数："+t._s(t.chosenfilenum))])])],1),t._v(" "),a("el-col",{attrs:{span:1}},[0===t.fileList.length?a("el-button",{staticStyle:{float:"right","margin-right":"150%","font-size":"14px"},attrs:{size:"small",type:"success",disabled:!0}},[t._v("开始识别")]):t._e(),t._v(" "),0!==t.fileList.length?a("el-button",{staticStyle:{float:"right","margin-right":"150%","font-size":"14px"},attrs:{size:"small",type:"success",disabled:t.in_prog},on:{click:t.submitUpload}},[t._v("开始识别")]):t._e()],1),t._v(" "),a("el-col",{attrs:{span:19}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.in_prog,expression:"in_prog"}]},[t._v("\n          "+t._s(t.prog_text)+"\n          "),a("el-progress",{staticStyle:{margin:"5px auto 50px auto",width:"80%"},attrs:{percentage:t.prog,"text-inside":!0,"stroke-width":26,status:t.prog_stat}})],1)])],1),t._v(" "),a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("Loc2d",{staticStyle:{height:"800px"},attrs:{figData:t.posFig}}),t._v(" "),a("Loc2d",{staticStyle:{height:"800px"},attrs:{figData:t.areaFig}})],1),t._v(" "),a("el-col",{attrs:{span:12}},[["success"===this.prog_stat?a("el-result",{staticStyle:{margin:"30px auto auto auto"},attrs:{icon:t.recog_res_icon,title:t.recog_res_text,"sub-title":t.recog_res_sub_text}}):t._e(),t._v(" "),a("div",{staticStyle:{"font-size":"14px"}},[t._v("\n            有目标帧数："+t._s(t.resultfilenum)+"\n          ")]),t._v(" "),a("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.tableData,stripe:!0,"max-height":1500,size:"small"}},[a("el-table-column",{attrs:{prop:"frame",label:"帧"}}),t._v(" "),a("el-table-column",{attrs:{prop:"excav",label:"挖机"}}),t._v(" "),a("el-table-column",{attrs:{prop:"top",label:"顶"}}),t._v(" "),a("el-table-column",{attrs:{prop:"left",label:"左"}}),t._v(" "),a("el-table-column",{attrs:{prop:"width",label:"宽"}}),t._v(" "),a("el-table-column",{attrs:{prop:"height",label:"高"}}),t._v(" "),a("el-table-column",{attrs:{prop:"area",label:"面积"}})],1)]],2)],1)],1)},staticRenderFns:[]};var S=a("VU/8")(y,w,!1,function(t){a("D4kW")},"data-v-2a921b6c",null).exports,k={components:{Loc2d:_},name:"WaveRecognition",data:function(){return{fileList:[],prog:0,in_prog:!1,prog_stat:null,prog_text:"正在上传文件，速度取决于网络状况，请耐心等待...",tableData:[],misData:[],timer:null,f_exist:!1,server_available:!1,recog_started:!1,originalFig:[{x:[],y:[],type:"scatter"}],processedFig:[{x:[],y:[],type:"scatter"}],originalFigLayout:{title:"原始波形"},processedFigLayout:{title:"单边振幅谱(归一化)"},recog_res_icon:"error",recog_res_text:"Unknown",recog_res_sub_text:"Recognition Error"}},computed:{chosenfilenum:function(){return this.fileList.length},resultfilenum:function(){return this.tableData.length}},methods:{rowStatus:function(t){t.row,t.rowIndex;return{"background-color":"oldlace"}},handleChange:function(t,e){var a=t.name.lastIndexOf("."),o=".xlsx"===t.name.substring(a,t.name.length).toLowerCase(),i=t.size/1024/1024<10;o||(this.$message.error("上传视频只能是 Xlsx 格式!"),e.pop()),i||(this.$message.error("上传文件大小不能超过 10MB!"),e.pop()),e.length>1&&(this.$message.error("单次识别数量不能超过 1!"),e.pop()),this.fileList=e},submitUpload:function(){var t=this;this.getToken().then(function(e){window.sessionStorage.setItem("token",e.data),t.server_available=!0,t.in_prog=!0,t.getProgress();var a=new FormData,o=1;t.fileList.forEach(function(t){a.append("id="+o.toString()+"="+t.name,t.raw),o+=1}),t.uploadFile(a).then(function(e){console.log(e),console.log(e.status),t.prog=100,t.prog_stat="success",t.prog_text="识别成功，刷新页面可重新上传",t.clearTimer();var a=e.data.res;for(var o in t.recog_res_icon="info",t.recog_res_sub_text="Recognition Done",0===a[0]?t.recog_res_text="设备未工作":t.recog_res_text="设备正在工作",a[1][0])t.originalFig[0].x.push(a[1][0][o]),t.originalFig[0].y.push(a[1][1][o]);for(var i in a[2][0])t.processedFig[0].x.push(a[2][0][i]),t.processedFig[0].y.push(a[2][1][i])}).catch(function(e){console.log(e),t.$message.error("上传识别失败！"),t.prog_stat="exception",t.prog_text="请刷新页面重试",t.clearTimer()})}).catch(function(e){console.log(e),t.server_available=!1,t.$message.error("服务当前同时使用人数过多！请稍后重试...")})},uploadFile:function(t){return this.$axios.post(this.$targetDomain+"/api/wave",t,{headers:{"Content-Type":"multipart/form-data",token:window.sessionStorage.getItem("token")}})},getProgress:function(){var t=this;this.timer=setInterval(function(){t.getStatus().then(function(e){-2===e.data?t.recog_started||(t.prog_text="正在上传文件，速度取决于网络状况，请耐心等待...",t.prog=0):-1===e.data?(t.clearTimer(),t.prog_text="仍正在识别，请耐心等待数分钟...如仍无结果请刷新页面重试"):(t.recog_started=!0,t.prog_text="已上传完成，正在识别，请耐心等待...",t.prog=Math.round(100*e.data),100===t.prog&&t.clearTimer())}).catch(function(e){t.clearTimer()})},2e3)},getStatus:function(){return this.$axios.get(this.$targetDomain+"/api/getprog",{params:{token:window.sessionStorage.getItem("token"),timeout:2e3}})},clearTimer:function(){clearInterval(this.timer),this.timer=null},export2excel:function(){this.getExcel().then(function(t){var e=new Blob([t.data],{type:"application/vnd.ms-excel"}),a=document.createElement("a"),o=new Date;a.download="核酸检测报告-"+o.getFullYear()+"-"+o.getMonth()+"-"+o.getDate()+"-"+o.getHours()+"-"+o.getMinutes()+"-"+o.getSeconds()+".xls",a.style.display="none",a.href=URL.createObjectURL(e),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)})},getExcel:function(){return this.$axios.get(this.$targetDomain+"/api/getexcel",{params:{token:window.sessionStorage.getItem("token")},responseType:"arraybuffer"})},getToken:function(){return this.$axios.get(this.$targetDomain+"/api/gettoken",{params:{}})},destroyToken:function(){var t=window.sessionStorage.getItem("token");if(null!=t)return this.$axios.delete(this.$targetDomain+"/api/destroytoken",{params:{token:t}})}},mode:"history",beforeDestroy:function(){clearInterval(this.timer),this.timer=null},beforeMount:function(){window.sessionStorage.removeItem("token"),this.server_available=!1},mounted:function(){window.addEventListener("beforeunload",function(t){})},created:function(){var t=this;this.$nextTick(function(){t.$refs.upload.$children[0].$refs.input.webkitdirectory=!0})}},$={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"margin-top":"30px"}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:1}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{float:"left","margin-left":"150%"},attrs:{action:"#",multiple:!0,"auto-upload":!1,"on-change":t.handleChange,"file-list":t.fileList,disabled:t.in_prog,"show-file-list":!1}},[a("el-button",{staticStyle:{"font-size":"14px"},attrs:{slot:"trigger",size:"small",type:"primary",disabled:t.in_prog},slot:"trigger"},[t._v("\n            选取Excel文件")])],1)],1),t._v(" "),a("el-col",{staticStyle:{"pointer-events":"none"},attrs:{span:3}},[a("el-upload",{ref:"upload",staticClass:"upload",attrs:{action:"#",multiple:!0,"auto-upload":!1,"on-change":t.handleChange,"file-list":t.fileList,disabled:t.in_prog}},[a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"30px","font-size":"14px"},attrs:{slot:"tip"},slot:"tip"},[t._v("\n            文件大小不能超过10MB")]),t._v(" "),a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"5px","font-size":"14px"},attrs:{slot:"tip"},slot:"tip"},[t._v("\n            选取文件数："+t._s(t.chosenfilenum))])])],1),t._v(" "),a("el-col",{attrs:{span:1}},[0===t.fileList.length?a("el-button",{staticStyle:{float:"right","margin-right":"150%","font-size":"14px"},attrs:{size:"small",type:"success",disabled:!0}},[t._v("开始识别")]):t._e(),t._v(" "),0!==t.fileList.length?a("el-button",{staticStyle:{float:"right","margin-right":"150%","font-size":"14px"},attrs:{size:"small",type:"success",disabled:t.in_prog},on:{click:t.submitUpload}},[t._v("开始识别")]):t._e()],1),t._v(" "),a("el-col",{attrs:{span:19}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.in_prog,expression:"in_prog"}]},[t._v("\n          "+t._s(t.prog_text)+"\n          "),a("el-progress",{staticStyle:{margin:"5px auto 50px auto",width:"80%"},attrs:{percentage:t.prog,"text-inside":!0,"stroke-width":26,status:t.prog_stat}})],1)])],1),t._v(" "),a("el-row",{attrs:{gutter:40}},["success"===this.prog_stat?a("el-result",{attrs:{icon:t.recog_res_icon,title:t.recog_res_text,"sub-title":t.recog_res_sub_text}}):t._e(),t._v(" "),a("el-col",{attrs:{span:12}},[a("Loc2d",{staticStyle:{height:"800px"},attrs:{figData:t.originalFig,figLayout:t.originalFigLayout}})],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("Loc2d",{staticStyle:{height:"800px"},attrs:{figData:t.processedFig,figLayout:t.processedFigLayout}})],1)],1)],1)},staticRenderFns:[]};var D=a("VU/8")(k,$,!1,function(t){a("yxJm")},"data-v-65dd549d",null).exports,L={components:{Loc2d:_},name:"DriverFace",data:function(){return{fileList:[],prog:0,in_prog:!1,prog_stat:null,prog_text:"正在上传文件，速度取决于网络状况，请耐心等待...",tableData:[],misData:[],timer:null,f_exist:!1,server_available:!1,recog_started:!1,originalFig:[{x:[],y:[],type:"scatter"}],processedFig:[{x:[],y:[],type:"scatter"}],originalFigLayout:{title:"原始波形"},processedFigLayout:{title:"单边振幅谱(归一化)"},recog_res_icon:"error",recog_res_text:"Unknown",recog_res_sub_text:"Recognition Error",equip_pos:!1,res_img:null}},computed:{chosenfilenum:function(){return this.fileList.length},resultfilenum:function(){return this.tableData.length}},methods:{rowStatus:function(t){t.row,t.rowIndex;return{"background-color":"oldlace"}},handleChange:function(t,e){var a=t.name.lastIndexOf("."),o=".jpg"===t.name.substring(a,t.name.length).toLowerCase(),i=t.size/1024/1024<10;o||(this.$message.error("上传图片只能是 JPG 格式!"),e.pop()),i||(this.$message.error("上传文件大小不能超过 10MB!"),e.pop()),e.length>1&&(this.$message.error("单次识别数量不能超过 1!"),e.pop()),this.fileList=e},submitUpload:function(){var t=this;this.getToken().then(function(e){window.sessionStorage.setItem("token",e.data),t.server_available=!0,t.in_prog=!0,t.getProgress();var a=new FormData,o=1;t.fileList.forEach(function(t){a.append("id="+o.toString()+"="+t.name,t.raw),o+=1}),a.append("equip_pos",t.equip_pos),t.uploadFile(a).then(function(e){console.log(e),console.log(e.status),t.prog=100,t.prog_stat="success",t.prog_text="识别成功，刷新页面可重新上传",t.clearTimer();var a=e.data.res;t.recog_res_icon="info",t.recog_res_sub_text="Recognition Done",-1===a?t.recog_res_text="未检测到人脸":(t.recog_res_text=0===a?"操作合规":"操作不合规",t.res_img=t.$targetDomain+"/api/driverFaceImg?token="+window.sessionStorage.getItem("token")+"&timeout=2000")}).catch(function(e){console.log(e),t.$message.error("上传识别失败！"),t.prog_stat="exception",t.prog_text="请刷新页面重试",t.clearTimer()})}).catch(function(e){console.log(e),t.server_available=!1,t.$message.error("服务当前同时使用人数过多！请稍后重试...")})},uploadFile:function(t){return this.$axios.post(this.$targetDomain+"/api/driverFace",t,{headers:{"Content-Type":"multipart/form-data",token:window.sessionStorage.getItem("token")}})},getProgress:function(){var t=this;this.timer=setInterval(function(){t.getStatus().then(function(e){-2===e.data?t.recog_started||(t.prog_text="正在上传文件，速度取决于网络状况，请耐心等待...",t.prog=0):-1===e.data?(t.clearTimer(),t.prog_text="仍正在识别，请耐心等待数分钟...如仍无结果请刷新页面重试"):(t.recog_started=!0,t.prog_text="已上传完成，正在识别，请耐心等待...",t.prog=Math.round(100*e.data),100===t.prog&&t.clearTimer())}).catch(function(e){t.clearTimer()})},2e3)},getStatus:function(){return this.$axios.get(this.$targetDomain+"/api/getprog",{params:{token:window.sessionStorage.getItem("token"),timeout:2e3}})},clearTimer:function(){clearInterval(this.timer),this.timer=null},export2excel:function(){this.getExcel().then(function(t){var e=new Blob([t.data],{type:"application/vnd.ms-excel"}),a=document.createElement("a"),o=new Date;a.download="核酸检测报告-"+o.getFullYear()+"-"+o.getMonth()+"-"+o.getDate()+"-"+o.getHours()+"-"+o.getMinutes()+"-"+o.getSeconds()+".xls",a.style.display="none",a.href=URL.createObjectURL(e),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)})},getExcel:function(){return this.$axios.get(this.$targetDomain+"/api/getexcel",{params:{token:window.sessionStorage.getItem("token")},responseType:"arraybuffer"})},getToken:function(){return this.$axios.get(this.$targetDomain+"/api/gettoken",{params:{}})},destroyToken:function(){var t=window.sessionStorage.getItem("token");if(null!=t)return this.$axios.delete(this.$targetDomain+"/api/destroytoken",{params:{token:t}})}},mode:"history",beforeDestroy:function(){clearInterval(this.timer),this.timer=null},beforeMount:function(){window.sessionStorage.removeItem("token"),this.server_available=!1},mounted:function(){window.addEventListener("beforeunload",function(t){})},created:function(){var t=this;this.$nextTick(function(){t.$refs.upload.$children[0].$refs.input.webkitdirectory=!0})}},T={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"margin-top":"30px"}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{staticStyle:{margin:"auto auto 40px 50px"},attrs:{span:2}},[t._v("\n      设备位置\n      "),a("el-switch",{staticClass:"switch",attrs:{"inline-prompt":"","active-text":"右","inactive-text":"左","inactive-color":"#13ce66"},model:{value:t.equip_pos,callback:function(e){t.equip_pos=e},expression:"equip_pos"}})],1)],1),t._v(" "),a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:1}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{float:"left","margin-left":"150%"},attrs:{action:"#",multiple:!0,"auto-upload":!1,"on-change":t.handleChange,"file-list":t.fileList,disabled:t.in_prog,"show-file-list":!1}},[a("el-button",{staticStyle:{"font-size":"14px"},attrs:{slot:"trigger",size:"small",type:"primary",disabled:t.in_prog},slot:"trigger"},[t._v("\n          选取图片")])],1)],1),t._v(" "),a("el-col",{staticStyle:{"pointer-events":"none"},attrs:{span:3}},[a("el-upload",{ref:"upload",staticClass:"upload",attrs:{action:"#",multiple:!0,"auto-upload":!1,"on-change":t.handleChange,"file-list":t.fileList,disabled:t.in_prog}},[a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"30px","font-size":"14px"},attrs:{slot:"tip"},slot:"tip"},[t._v("\n          文件大小不能超过10MB")]),t._v(" "),a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"5px","font-size":"14px"},attrs:{slot:"tip"},slot:"tip"},[t._v("\n          选取文件数："+t._s(t.chosenfilenum))])])],1),t._v(" "),a("el-col",{attrs:{span:1}},[0===t.fileList.length?a("el-button",{staticStyle:{float:"right","margin-right":"150%","font-size":"14px"},attrs:{size:"small",type:"success",disabled:!0}},[t._v("开始识别")]):t._e(),t._v(" "),0!==t.fileList.length?a("el-button",{staticStyle:{float:"right","margin-right":"150%","font-size":"14px"},attrs:{size:"small",type:"success",disabled:t.in_prog},on:{click:t.submitUpload}},[t._v("开始识别")]):t._e()],1),t._v(" "),a("el-col",{attrs:{span:19}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.in_prog,expression:"in_prog"}]},[t._v("\n        "+t._s(t.prog_text)+"\n        "),a("el-progress",{staticStyle:{margin:"5px auto 50px auto",width:"80%"},attrs:{percentage:t.prog,"text-inside":!0,"stroke-width":26,status:t.prog_stat}})],1)])],1),t._v(" "),a("el-row",{attrs:{gutter:40}},[a("el-col",{staticStyle:{margin:"50px 50px"},attrs:{span:12}},[a("span",{directives:[{name:"show",rawName:"v-show",value:100!==this.prog,expression:"this.prog !== 100"}],staticClass:"demonstration",staticStyle:{display:"block"}},[t._v("待识别...")]),t._v(" "),a("el-image",{staticStyle:{width:"1000px",height:"600px","margin-top":"10px"},attrs:{src:t.res_img,fit:"scale-down"},scopedSlots:t._u([{key:"placeholder",fn:function(){return[a("div",{staticClass:"image-slot"},[t._v("Loading"),a("span",{staticClass:"dot"},[t._v("...")])])]},proxy:!0}])})],1),t._v(" "),a("el-col",{attrs:{span:3}},["success"===this.prog_stat?a("el-result",{staticStyle:{margin:"30px auto auto auto"},attrs:{icon:t.recog_res_icon,title:t.recog_res_text,"sub-title":t.recog_res_sub_text}}):t._e()],1)],1),t._v(" "),a("el-row",{attrs:{gutter:40}})],1)},staticRenderFns:[]};var I=a("VU/8")(L,T,!1,function(t){a("Dbc7")},"data-v-42d599bc",null).exports,F={components:{Loc2d:_},name:"DriverAction",data:function(){return{fileList:[],prog:0,in_prog:!1,prog_stat:null,prog_text:"正在上传文件，速度取决于网络状况，请耐心等待...",tableData:[],misData:[],timer:null,f_exist:!1,server_available:!1,recog_started:!1,disFig:[{x:[],y:[],type:"scatter"},{x:[],y:[],type:"scatter"}],angleFig:[{x:[],y:[],type:"scatter"},{x:[],y:[],type:"scatter"}],recog_res_icon:"error",recog_res_text:"Unknown",recog_res_sub_text:"Recognition Error",equip_pos:!1,res_img:null}},computed:{chosenfilenum:function(){return this.fileList.length},resultfilenum:function(){return this.tableData.length}},methods:{rowStatus:function(t){t.row,t.rowIndex;return{"background-color":"oldlace"}},handleChange:function(t,e){var a=t.name.lastIndexOf("."),o=".json"===t.name.substring(a,t.name.length).toLowerCase(),i=t.size/1024/1024<10;o||(this.$message.error("上传图片只能是 JSON 格式!"),e.pop()),i||(this.$message.error("上传文件大小不能超过 10MB!"),e.pop()),e.length>1&&(this.$message.error("单次识别数量不能超过 1!"),e.pop()),this.fileList=e},submitUpload:function(){var t=this;this.getToken().then(function(e){window.sessionStorage.setItem("token",e.data),t.server_available=!0,t.in_prog=!0,t.getProgress();var a=new FormData,o=1;t.fileList.forEach(function(t){a.append("id="+o.toString()+"="+t.name,t.raw),o+=1}),t.uploadFile(a).then(function(e){console.log(e),console.log(e.status),t.prog=100,t.prog_stat="success",t.prog_text="识别成功，刷新页面可重新上传",t.clearTimer();var a=e.data.res;t.recog_res_icon="info",t.recog_res_sub_text="Recognition Done",0===a[0]?t.recog_res_text="操作合规（未在接打电话）":t.recog_res_text="操作不合规（有接打电话行为）";var o=a[1];for(var i in o)console.log(i),t.tableData.push({frame:o[i][0],leftDis:o[i][1],rightDis:o[i][2],leftAngle:o[i][3],rightAngle:o[i][4]}),t.disFig[0].x.push(o[i][0]),t.disFig[0].y.push(o[i][1]),t.disFig[1].x.push(o[i][0]),t.disFig[1].y.push(o[i][2]),t.angleFig[0].x.push(o[i][0]),t.angleFig[0].y.push(o[i][3]),t.angleFig[1].x.push(o[i][0]),t.angleFig[1].y.push(o[i][4])}).catch(function(e){console.log(e),t.$message.error("上传识别失败！"),t.prog_stat="exception",t.prog_text="请刷新页面重试",t.clearTimer()})}).catch(function(e){console.log(e),t.server_available=!1,t.$message.error("服务当前同时使用人数过多！请稍后重试...")})},uploadFile:function(t){return this.$axios.post(this.$targetDomain+"/api/driverAction",t,{headers:{"Content-Type":"multipart/form-data",token:window.sessionStorage.getItem("token")}})},getProgress:function(){var t=this;this.timer=setInterval(function(){t.getStatus().then(function(e){-2===e.data?t.recog_started||(t.prog_text="正在上传文件，速度取决于网络状况，请耐心等待...",t.prog=0):-1===e.data?(t.clearTimer(),t.prog_text="仍正在识别，请耐心等待数分钟...如仍无结果请刷新页面重试"):(t.recog_started=!0,t.prog_text="已上传完成，正在识别，请耐心等待...",t.prog=Math.round(100*e.data),100===t.prog&&t.clearTimer())}).catch(function(e){t.clearTimer()})},2e3)},getStatus:function(){return this.$axios.get(this.$targetDomain+"/api/getprog",{params:{token:window.sessionStorage.getItem("token"),timeout:2e3}})},clearTimer:function(){clearInterval(this.timer),this.timer=null},export2excel:function(){this.getExcel().then(function(t){var e=new Blob([t.data],{type:"application/vnd.ms-excel"}),a=document.createElement("a"),o=new Date;a.download="核酸检测报告-"+o.getFullYear()+"-"+o.getMonth()+"-"+o.getDate()+"-"+o.getHours()+"-"+o.getMinutes()+"-"+o.getSeconds()+".xls",a.style.display="none",a.href=URL.createObjectURL(e),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)})},getExcel:function(){return this.$axios.get(this.$targetDomain+"/api/getexcel",{params:{token:window.sessionStorage.getItem("token")},responseType:"arraybuffer"})},getToken:function(){return this.$axios.get(this.$targetDomain+"/api/gettoken",{params:{}})},destroyToken:function(){var t=window.sessionStorage.getItem("token");if(null!=t)return this.$axios.delete(this.$targetDomain+"/api/destroytoken",{params:{token:t}})}},mode:"history",beforeDestroy:function(){clearInterval(this.timer),this.timer=null},beforeMount:function(){window.sessionStorage.removeItem("token"),this.server_available=!1},mounted:function(){window.addEventListener("beforeunload",function(t){})},created:function(){var t=this;this.$nextTick(function(){t.$refs.upload.$children[0].$refs.input.webkitdirectory=!0})}},C={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"margin-top":"30px"}},[a("el-row",{attrs:{gutter:40}}),t._v(" "),a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:1}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{float:"left","margin-left":"150%"},attrs:{action:"#",multiple:!0,"auto-upload":!1,"on-change":t.handleChange,"file-list":t.fileList,disabled:t.in_prog,"show-file-list":!1}},[a("el-button",{staticStyle:{"font-size":"14px"},attrs:{slot:"trigger",size:"small",type:"primary",disabled:t.in_prog},slot:"trigger"},[t._v("\n            选取JSON")])],1)],1),t._v(" "),a("el-col",{staticStyle:{"pointer-events":"none"},attrs:{span:3}},[a("el-upload",{ref:"upload",staticClass:"upload",attrs:{action:"#",multiple:!0,"auto-upload":!1,"on-change":t.handleChange,"file-list":t.fileList,disabled:t.in_prog}},[a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"30px","font-size":"14px"},attrs:{slot:"tip"},slot:"tip"},[t._v("\n            文件大小不能超过10MB")]),t._v(" "),a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"5px","font-size":"14px"},attrs:{slot:"tip"},slot:"tip"},[t._v("\n            选取文件数："+t._s(t.chosenfilenum))])])],1),t._v(" "),a("el-col",{attrs:{span:1}},[0===t.fileList.length?a("el-button",{staticStyle:{float:"right","margin-right":"150%","font-size":"14px"},attrs:{size:"small",type:"success",disabled:!0}},[t._v("开始识别")]):t._e(),t._v(" "),0!==t.fileList.length?a("el-button",{staticStyle:{float:"right","margin-right":"150%","font-size":"14px"},attrs:{size:"small",type:"success",disabled:t.in_prog},on:{click:t.submitUpload}},[t._v("开始识别")]):t._e()],1),t._v(" "),a("el-col",{attrs:{span:19}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.in_prog,expression:"in_prog"}]},[t._v("\n          "+t._s(t.prog_text)+"\n          "),a("el-progress",{staticStyle:{margin:"5px auto 50px auto",width:"80%"},attrs:{percentage:t.prog,"text-inside":!0,"stroke-width":26,status:t.prog_stat}})],1)])],1),t._v(" "),a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:12}},[a("Loc2d",{staticStyle:{height:"800px"},attrs:{figData:t.disFig}}),t._v(" "),a("Loc2d",{staticStyle:{height:"800px"},attrs:{figData:t.angleFig}})],1),t._v(" "),a("el-col",{attrs:{span:12}},["success"===this.prog_stat?a("el-result",{staticStyle:{margin:"30px auto auto auto"},attrs:{icon:t.recog_res_icon,title:t.recog_res_text,"sub-title":t.recog_res_sub_text}}):t._e(),t._v(" "),[a("div",{staticStyle:{"font-size":"14px"}},[t._v("\n            有目标帧数："+t._s(t.resultfilenum)+"\n          ")]),t._v(" "),a("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.tableData,stripe:!0,"max-height":1500,size:"small"}},[a("el-table-column",{attrs:{prop:"frame",label:"帧"}}),t._v(" "),a("el-table-column",{attrs:{prop:"leftDis",label:"左手距离"}}),t._v(" "),a("el-table-column",{attrs:{prop:"rightDis",label:"右手距离"}}),t._v(" "),a("el-table-column",{attrs:{prop:"leftAngle",label:"左手角度"}}),t._v(" "),a("el-table-column",{attrs:{prop:"rightAngle",label:"右手角度"}})],1)]],2)],1)],1)},staticRenderFns:[]};var z=a("VU/8")(F,C,!1,function(t){a("/NSH")},"data-v-281f0dfc",null).exports,U={components:{Loc2d:_},name:"Equip",data:function(){return{fileList:[],prog:0,in_prog:!1,prog_stat:null,prog_text:"正在上传文件，速度取决于网络状况，请耐心等待...",tableData:[{title:"合规",worker:0,manager:0,tech:0,sup:0,other:0},{title:"不合规",worker:0,manager:0,tech:0,sup:0,other:0}],misData:[],timer:null,f_exist:!1,server_available:!1,recog_started:!1,originalFig:[{x:[],y:[],type:"scatter"}],processedFig:[{x:[],y:[],type:"scatter"}],originalFigLayout:{title:"原始波形"},processedFigLayout:{title:"单边振幅谱(归一化)"},recog_res_icon:"error",recog_res_text:"Unknown",recog_res_sub_text:"Recognition Error",equip_pos:!1,res_img:null}},computed:{chosenfilenum:function(){return this.fileList.length},resultfilenum:function(){return this.tableData.length}},methods:{rowStatus:function(t){t.row,t.rowIndex;return{"background-color":"oldlace"}},handleChange:function(t,e){var a=t.name.lastIndexOf("."),o=".jpg"===t.name.substring(a,t.name.length).toLowerCase(),i=t.size/1024/1024<10;o||(this.$message.error("上传图片只能是 JPG 格式!"),e.pop()),i||(this.$message.error("上传文件大小不能超过 10MB!"),e.pop()),e.length>1&&(this.$message.error("单次识别数量不能超过 1!"),e.pop()),this.fileList=e},submitUpload:function(){var t=this;this.getToken().then(function(e){window.sessionStorage.setItem("token",e.data),t.server_available=!0,t.in_prog=!0,t.getProgress();var a=new FormData,o=1;t.fileList.forEach(function(t){a.append("id="+o.toString()+"="+t.name,t.raw),o+=1}),t.uploadFile(a).then(function(e){console.log(e),console.log(e.status),t.prog=100,t.prog_stat="success",t.prog_text="识别成功，刷新页面可重新上传",t.clearTimer(),t.recog_res_icon="info",t.recog_res_sub_text="Recognition Done";var a=e.data;if(null===a)t.recog_res_text="未检测到人";else{var o=a.res;t.recog_res_text="检测完成",t.tableData[0].worker=o[0][0],t.tableData[1].worker=o[0][1],t.tableData[0].manager=o[1][0],t.tableData[1].manager=o[1][1],t.tableData[0].tech=o[2][0],t.tableData[1].tech=o[2][1],t.tableData[0].sup=o[3][0],t.tableData[1].sup=o[3][1],t.tableData[0].other=o[4][0],t.tableData[1].other=o[4][1],t.res_img=t.$targetDomain+"/api/equipImg?token="+window.sessionStorage.getItem("token")+"&timeout=2000"}}).catch(function(e){console.log(e),t.$message.error("上传识别失败！"),t.prog_stat="exception",t.prog_text="请刷新页面重试",t.clearTimer()})}).catch(function(e){console.log(e),t.server_available=!1,t.$message.error("服务当前同时使用人数过多！请稍后重试...")})},uploadFile:function(t){return this.$axios.post(this.$targetDomain+"/api/equip",t,{headers:{"Content-Type":"multipart/form-data",token:window.sessionStorage.getItem("token")}})},getProgress:function(){var t=this;this.timer=setInterval(function(){t.getStatus().then(function(e){-2===e.data?t.recog_started||(t.prog_text="正在上传文件，速度取决于网络状况，请耐心等待...",t.prog=0):-1===e.data?(t.clearTimer(),t.prog_text="仍正在识别，请耐心等待数分钟...如仍无结果请刷新页面重试"):(t.recog_started=!0,t.prog_text="已上传完成，正在识别，请耐心等待...",t.prog=Math.round(100*e.data),100===t.prog&&t.clearTimer())}).catch(function(e){t.clearTimer()})},2e3)},getStatus:function(){return this.$axios.get(this.$targetDomain+"/api/getprog",{params:{token:window.sessionStorage.getItem("token"),timeout:2e3}})},clearTimer:function(){clearInterval(this.timer),this.timer=null},export2excel:function(){this.getExcel().then(function(t){var e=new Blob([t.data],{type:"application/vnd.ms-excel"}),a=document.createElement("a"),o=new Date;a.download="核酸检测报告-"+o.getFullYear()+"-"+o.getMonth()+"-"+o.getDate()+"-"+o.getHours()+"-"+o.getMinutes()+"-"+o.getSeconds()+".xls",a.style.display="none",a.href=URL.createObjectURL(e),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)})},getExcel:function(){return this.$axios.get(this.$targetDomain+"/api/getexcel",{params:{token:window.sessionStorage.getItem("token")},responseType:"arraybuffer"})},getToken:function(){return this.$axios.get(this.$targetDomain+"/api/gettoken",{params:{}})},destroyToken:function(){var t=window.sessionStorage.getItem("token");if(null!=t)return this.$axios.delete(this.$targetDomain+"/api/destroytoken",{params:{token:t}})}},mode:"history",beforeDestroy:function(){clearInterval(this.timer),this.timer=null},beforeMount:function(){window.sessionStorage.removeItem("token"),this.server_available=!1},mounted:function(){window.addEventListener("beforeunload",function(t){})},created:function(){var t=this;this.$nextTick(function(){t.$refs.upload.$children[0].$refs.input.webkitdirectory=!0})}},R={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"margin-top":"30px"}},[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:1}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{float:"left","margin-left":"150%"},attrs:{action:"#",multiple:!0,"auto-upload":!1,"on-change":t.handleChange,"file-list":t.fileList,disabled:t.in_prog,"show-file-list":!1}},[a("el-button",{staticStyle:{"font-size":"14px"},attrs:{slot:"trigger",size:"small",type:"primary",disabled:t.in_prog},slot:"trigger"},[t._v("\n          选取图片")])],1)],1),t._v(" "),a("el-col",{staticStyle:{"pointer-events":"none"},attrs:{span:3}},[a("el-upload",{ref:"upload",staticClass:"upload",attrs:{action:"#",multiple:!0,"auto-upload":!1,"on-change":t.handleChange,"file-list":t.fileList,disabled:t.in_prog}},[a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"30px","font-size":"14px"},attrs:{slot:"tip"},slot:"tip"},[t._v("\n          文件大小不能超过10MB")]),t._v(" "),a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"5px","font-size":"14px"},attrs:{slot:"tip"},slot:"tip"},[t._v("\n          选取文件数："+t._s(t.chosenfilenum))])])],1),t._v(" "),a("el-col",{attrs:{span:1}},[0===t.fileList.length?a("el-button",{staticStyle:{float:"right","margin-right":"150%","font-size":"14px"},attrs:{size:"small",type:"success",disabled:!0}},[t._v("开始识别")]):t._e(),t._v(" "),0!==t.fileList.length?a("el-button",{staticStyle:{float:"right","margin-right":"150%","font-size":"14px"},attrs:{size:"small",type:"success",disabled:t.in_prog},on:{click:t.submitUpload}},[t._v("开始识别")]):t._e()],1),t._v(" "),a("el-col",{attrs:{span:19}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.in_prog,expression:"in_prog"}]},[t._v("\n        "+t._s(t.prog_text)+"\n        "),a("el-progress",{staticStyle:{margin:"5px auto 50px auto",width:"80%"},attrs:{percentage:t.prog,"text-inside":!0,"stroke-width":26,status:t.prog_stat}})],1)])],1),t._v(" "),a("el-row",{attrs:{gutter:40}},[a("el-col",{staticStyle:{margin:"50px 50px"},attrs:{span:12}},[a("span",{directives:[{name:"show",rawName:"v-show",value:100!==this.prog,expression:"this.prog !== 100"}],staticClass:"demonstration",staticStyle:{display:"block"}},[t._v("待识别...")]),t._v(" "),a("el-image",{staticStyle:{width:"1000px",height:"600px","margin-top":"10px"},attrs:{src:t.res_img,fit:"contain"},scopedSlots:t._u([{key:"placeholder",fn:function(){return[a("div",{staticClass:"image-slot"},[t._v("Loading"),a("span",{staticClass:"dot"},[t._v("...")])])]},proxy:!0}])})],1),t._v(" "),a("el-col",{attrs:{span:8}},["success"===this.prog_stat?a("el-result",{staticStyle:{margin:"30px auto auto auto"},attrs:{icon:t.recog_res_icon,title:t.recog_res_text,"sub-title":t.recog_res_sub_text}}):t._e(),t._v(" "),a("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.tableData,stripe:!0,"max-height":1500,size:"small"}},[a("el-table-column",{attrs:{label:" "}},[a("el-table-column",{attrs:{prop:"title",label:" "}})],1),t._v(" "),a("el-table-column",{attrs:{label:"戴安全帽"}},[a("el-table-column",{attrs:{prop:"worker",label:"普通工人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"manager",label:"管理人员"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tech",label:"技术人员"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sup",label:"监理"}})],1),t._v(" "),a("el-table-column",{attrs:{label:"未戴安全帽"}},[a("el-table-column",{attrs:{prop:"other",label:"未知"}})],1)],1)],1)],1),t._v(" "),a("el-row",{attrs:{gutter:40}})],1)},staticRenderFns:[]};var E=a("VU/8")(U,R,!1,function(t){a("6oa8")},"data-v-d53e12fa",null).exports;o.default.use(n.a);var M=new n.a({routes:[{path:"/",redirect:"/index"},{path:"/index",name:"Navi",component:b},{path:"/excavatorState",name:"ExcavatorState",component:S},{path:"/waveRecognition",name:"WaveRecognition",component:D},{path:"/driverFace",name:"DriverFace",component:I},{path:"/driverAction",name:"DriverAction",component:z},{path:"/equip",name:"Equip",component:E}],mode:"history"}),O=a("zL8q"),B=a.n(O);a("tvR6");o.default.config.productionTip=!1,o.default.use(B.a),o.default.prototype.$axios=l.a;o.default.prototype.$targetDomain="https://x.gqsong.xyz:443",new o.default({el:"#app",axios:l.a,targetDomain:"https://x.gqsong.xyz:443",router:M,components:{App:r},template:"<App/>"})},"R/11":function(t,e){},XR2M:function(t,e){},iXrt:function(t,e){},lUYF:function(t,e,a){t.exports=a.p+"static/img/tongji-w.9f17702.png"},sDrd:function(t,e){},tvR6:function(t,e){},yxJm:function(t,e){},zfvm:function(t,e,a){t.exports=a.p+"static/img/logo-w.7285c59.png"}},["NHnr"]);
//# sourceMappingURL=app.709e0d3371e8ab61ef74.js.map